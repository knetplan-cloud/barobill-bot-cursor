🤖 세무 챗봇 고도화 가이드 (Cursor AI 요청용)
1. 개요
이 문서는 barobill-bot-cursor 프로젝트의 date-utils.ts와 barobill-knowledge.json 파일을 고도화하기 위한 기획 가이드 및 데이터 자료입니다. 챗봇이 사용자의 날짜 기반 세무 질문(예: "10월 16일 반품 건")을 이해하고, 현행 세법(2025년 기준)에 맞는 정확한 마감일과 가산세 정보를 동적으로 계산하여 답변하도록 하는 것이 목표입니다.

2. KNOWLEDGE_BASE_GUIDE.md 보완 및 확정
기존 KNOWLEDGE_BASE_GUIDE.md의 내용을 기반으로, 세무 봇의 핵심 기능인 날짜 계산 로직을 명확하게 정의하고, 기획자님의 엑셀 시트를 반영하여 완성된 가이드입니다.

2.1. barobill-knowledge.json 컬럼 상세 정의
01_질문답변(Main).csv의 모든 컬럼과 JSON Key를 매핑합니다.

엑셀 컬럼명,JSON Key (실제 코드),필수,설명 (비고)
ID,id,✅,고유 식별자. (예: KB-TX-001)
구분,type,✅,"질문 유형. (intent, knowledge, case)"
대분류,category,✅,"메인 카테고리. (예: 세금계산서, 부가세)"
질문,title,✅,질문 제목. (Admin 페이지 노출 및 검색 가중치 +20점)
설명,description,❌,해당 질문에 대한 보충 설명. (관리자 참고용)
우선순위,priority,✅,1~10 숫자. (엔진 점수에 그대로 합산됨)
키워드,keywords,✅,"쉼표(,)로 구분. (매칭 시 +10점)"
제외키워드,negativeKeywords,❌,"쉼표(,)로 구분. (매칭 시 0점 탈락)"
날짜템플릿,dateTemplate,❌,날짜 자동계산 기능 활성화 (Y 또는 TRUE) (매칭 시 +15점)
격식체답변,responses.formal,✅,"~입니다, ~하십시오 (필수)"
해요체답변,responses.casual,❌,"~에요, ~해요 (권장)"
반말답변,responses.informal,❌,"[엑셀에 누락됨] ~야, ~해 (어투 확장용)"
평어체답변,responses.plain,❌,"~함, ~임 (설명조)"
관련가이드URL,relatedGuides,❌,"답변 하단 버튼. (형식: 타이틀|URL|아이콘, 여러 개면 줄바꿈)"
추천 후속 질문,followUpQuestions,❌,"답변 하단 추천 질문 버튼. (쉼표(,)로 구분)"
Source,source,❌,[엑셀-JSON 변환 시 추가] 데이터 출처. (예: excel_import)
Status,status,❌,"[엑셀-JSON 변환 시 추가] 데이터 상태. (예: active, pending)"

2.2. 날짜 템플릿 (dateTemplate: true) 작동 원리 정의
이것이 세무 봇의 핵심입니다. 기획자는 답변에 **동적 변수(Dynamic Variable)**를 심어두기만 하면, date-utils.ts가 현행 세법에 맞게 날짜를 자동으로 계산하여 치환합니다.
동적 변수,date-utils.ts의 역할 (자동 계산 로직)
{date},"사용자가 질문한 날짜. (예: ""10월 16일 반품"" → 2025-10-16)"
{today},챗봇이 답변하는 현재 날짜. (예: 2025-11-17)
{issueDeadline},세금계산서 발급기한. {date}가 속한 달의 다음 달 10일 (공휴일/주말인 경우 다음 영업일)
{vatDeadline},"부가세 (예정/확정) 신고기한. {date}가 속한 과세기간의 마감일 (1/25, 4/25, 7/25, 10/25) (공휴일/주말 고려)"
{amendmentDeadline},수정발급 안전 기한 (가산세 X). 사유에 따라 다름 (아래 3번 항목 참조)

3. date-utils.ts 고도화 로직 (세법 기준)
Cursor AI에 src/lib/date-utils.ts 파일에 아래 세법 기준을 적용하여 날짜 계산 함수를 고도화해달라고 요청하세요.

3.1. 부가세 신고기한 (getVatFilingDeadline)
{date} (거래일) 기준으로 부가세 신고기한({vatDeadline})을 계산합니다. (공휴일/주말 자동 연장 포함)

{date}가 1/1 ~ 6/30 사이 → 7월 25일 (1기 확정)

{date}가 7/1 ~ 12/31 사이 → 다음 해 1월 25일 (2기 확정)

(법인 예정신고) {date}가 1/1 ~ 3/31 → 4월 25일

(법인 예정신고) {date}가 7/1 ~ 9/30 → 10월 25일

3.2. 수정세금계산서 발급기한 (getAmendmentDeadline)
이것이 가장 복잡하고 중요한 로직입니다. 수정사유에 따라 작성일자와 가산세 기준이 완전히 다릅니다.

A. 사유 발생일 기준 (날짜 변경 O, 가산세 위험 O)
대상: 환입, 계약해제, 공급가액변동

규칙: 사유가 발생한 날(예: 반품일)을 새로운 작성일자로 하여, 그날이 속한 달의 다음 달 10일까지 발급해야 합니다. (일반 발급과 동일)

{amendmentDeadline} 계산: getInvoiceIssuanceDeadline(사유발생일)

B. 원본 작성일 기준 (날짜 변경 X, 가산세 위험 X)
대상: 기재사항 착오, 이중발급, 내국신용장 사후개설

규칙: 원본 작성일자로 수정발급하며, 원본의 부가세 확정신고기한({vatDeadline}) 이내에만 수정하면 가산세가 없습니다.

{amendmentDeadline} 계산: getVatFilingDeadline(원본거래일)

4. 세무 챗봇 날짜 템플릿 로직 가이드 (Date Logic Guide for Tax Bot)
1) 개요
이 문서는 date-utils.ts의 날짜 계산 로직을 고도화하기 위한 현행 세법 기준(2025년)을 정의합니다. 챗봇은 이 로직을 사용하여 사용자 질문에서 추출한 날짜({date})를 기준으로 각종 마감일({deadline})과 가산세 여부({penalty})를 동적으로 계산하고 답변해야 합니다.

2) 핵심 날짜 규칙 정의
2) 1. 부가가치세 신고기한 ({vatDeadline})
기본 규칙: 과세기간 종료 후 25일 이내.

공휴일/주말 규칙: 마감일이 토요일, 공휴일인 경우 그다음 영업일(평일)까지 연장됩니다. (예: 2025년 1월 25일은 토요일이므로 실제 마감일은 1월 27일(월))
과세 기간 (기준 날짜 {date} 포함),대상,신고 및 납부 기한 ({vatDeadline})
1월 1일 ~ 6월 30일,"개인 일반과세자, 법인",7월 25일
7월 1일 ~ 12월 31일,"개인 일반과세자, 법인",다음 해 1월 25일
1월 1일 ~ 3월 31일,법인 (예정신고),4월 25일
7월 1일 ~ 9월 30일,법인 (예정신고),10월 25일
1월 1일 ~ 12월 31일,개인 간이과세자,다음 해 1월 25일

2) 2. 세금계산서 발급기한 ({issueDeadline})
기본 규칙: 재화 또는 용역의 공급일이 속하는 달의 다음 달 10일까지 발급해야 합니다.

공휴일/주말 규칙: 10일이 공휴일/토요일인 경우, 그다음 영업일까지 연장됩니다.

예: 2025년 4월 공급분 → 5월 10일(토)이므로 5월 12일(월)까지 발급.

예: 2025년 9월 공급분 → 10월 10일(금)이 공휴일(추석 연휴 등)과 겹칠 경우 10월 15일까지 연장될 수 있음. (특수일정 반영 필요)

2) 3. 세금계산서 전송기한 ({transmitDeadline})
기본 규칙: 발급일(전자서명일) 기준 다음 날까지 국세청에 전송해야 합니다.

3) 가산세 발생 기준 ({penaltyInfo})
사용자가 날짜를 언급하며 질문 시, 가산세 발생 여부를 판단하여 안내해야 합니다.

3) 1. 발급 관련 가산세 (공급자)
지연발급 (1%)

기준: 발급기한({issueDeadline})은 놓쳤으나, 부가세 신고기한({vatDeadline}) 이내에 발급한 경우.

예: 10월 16일 거래 → 발급기한 11월 10일. → 11월 11일 ~ 다음 해 1월 25일 사이에 발급 시 '지연발급' (1%) 적용.

미발급 (2%)

기준: 부가세 신고기한({vatDeadline})까지 발급하지 않은 경우.

예: 10월 16일 거래 → 다음 해 1월 25일이 지나도록 발급하지 않으면 '미발급' (2%) 적용.

3) 2. 전송 관련 가산세 (공급자)
지연전송 (0.3%)

기준: 발급일 다음 날({transmitDeadline}) 이후 ~ 부가세 신고기한({vatDeadline}) 이내에 전송한 경우.

미전송 (0.5%)

기준: 부가세 신고기한({vatDeadline})까지 전송하지 않은 경우.

4) 수정세금계산서 발급 기준 (가산세 없이)
"가산세 없이" 수정하는 것이 핵심입니다. 이는 사유별로 발급기한이 다릅니다.

4) 1. "새로운 날짜"로 발급해야 하는 사유 (가산세 위험 O)
이 사유들은 사유 발생일(기준일)의 다음 달 10일까지 수정발급을 완료해야 합니다. 기한을 넘기면 위 3.1의 '지연/미발급' 가산세가 적용됩니다.

수정 사유,발급 (작성) 기준일,수정 발급기한
환입 (반품),재화가 환입된 날,환입된 날의 다음 달 10일
계약의 해제,계약이 해제된 날,계약 해제일의 다음 달 10일
공급가액 변동,변동 사유가 발생한 날,변동 발생일의 다음 달 10일

4) 2. "원본 날짜"로 발급해야 하는 사유 (가산세 위험 X)
이 사유들은 '실수'를 바로잡는 것이므로, 부가세 신고기한({vatDeadline}) 이내에만 발견하여 수정하면 별도 가산세가 없습니다.

수정 사유,발급 (작성) 기준일,수정 발급기한 (가산세 X)
기재사항 착오,당초 원본 작성일,부가세 확정신고기한 이내
이중발급,(사유 선택 시 자동),부가세 확정신고기한 이내
공급받는 자 착오,(2장 발급),[주의] 부가세 확정신고기한 이내 (기한 넘기면 미발급 2% 가산세)

5) Cursor AI 요청 가이드 (date-utils.ts 확장)

Cursor AI에게 src/lib/date-utils.ts 파일에 아래 함수들을 구현해달라고 요청하세요.

// (기존) 부가세 확정신고 기한 (공휴일/주말 고려 로직 보강 필요)
function getVatFilingDeadline(date: Date): Date { ... }

// [신규] 세금계산서 발급 마감일 (공휴일/주말 고려)
// 예: 10월 16일 -> 11월 10일
function getInvoiceIssuanceDeadline(date: Date): Date { ... }

// [신규] 세금계산서 전송 마감일 (공휴일/주말 고려)
// 예: 발급일(date) -> 발급일 + 1 (영업일)
function getInvoiceTransmissionDeadline(issueDate: Date): Date { ... }

// [신규] 수정세금계산서 "사유별" 마감일
// 예: (사유, 날짜) -> 마감일
// (reason: "환입" | "계약해제" | "착오정정", date: Date)
function getAmendmentDeadline(reason: string, eventDate: Date): Date {
  if (reason === "환입" || reason === "계약해제") {
    // 사유 발생일(eventDate)의 다음 달 10일
    return getInvoiceIssuanceDeadline(eventDate); 
  }
  if (reason === "착오정정") {
    // 원본 날짜(eventDate)가 속한 과세기간의 확정신고기한
    return getVatFilingDeadline(eventDate);
  }
  // ...
}

----


5. 최종 점검 체크리스트
점검 항목,완료 여부,상세 내용
MD 가이드 정비,✅,KNOWLEDGE_BASE_GUIDE.md의 내용을 보완하여 Cursor AI가 이해할 수 있는 명확한 가이드로 재구성했습니다.
세법 정확성 (Deep Research),✅,"부가세 신고기한, 발급기한, 수정사유별 작성일자 및 가산세 기준을 2025년 현행법 기준으로 검증했습니다."
날짜 로직 구체화,✅,"date-utils.ts가 계산해야 할 {vatDeadline}, {issueDeadline}, {amendmentDeadline}의 명확한 기준을 제시했습니다."
상황별 예시 구성 (Goal),✅,"""2025년 9월 16일"" 기준으로 6가지 수정 사유(환입, 해제, 변동, 착오, 이중, 사후개설)에 대한 JSON items를 모두 작성했습니다."
가산세 기한 반영,✅,"""가산세 없이"" 수정 가능한 기한(부가세 확정신고기한: 2026-01-25)과 ""사유 발생일"" 기준 기한(다음 달 10일)을 명확히 구분하여 예시에 반영했습니다."
데이터 형식 준수,✅,"모든 예시 데이터는 barobill-knowledge.json의 items 형식(priority, 3가지 어투, dateTemplate 등)을 완벽하게 따릅니다."